category: Data Enrichment & Threat Intelligence
commonfields:
  id: AnalyticsAndSIEM
  version: -1
configuration:
- defaultvalue: https://example.com
  display: Server URL (e.g. https://example.com)
  name: url
  required: true
  type: 0
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
- display: User
  name: user
  required: true
  type: 0
- display: Password
  name: password
  required: true
  type: 4
description: Get live feeds of IOC data from PhishLabs.
display: PhishLabsI IOC v2
name: AnalyticsAndSIEM
script:
  commands:
  - arguments:
    - default: false
      description: Incident ID
      isArray: false
      name: id
      required: true
      secret: false
    deprecated: false
    description: Retrieve incident details by id
    execution: false
    name: phishlabs-get-incident-by-id
    outputs:
    - contextPath: Email.To
      description: The recipient of the email.
      type: String
    - contextPath: Email.From
      description: The sender of the email.
      type: String
    - contextPath: Email.Body/HTML
      description: The HTML version of the email.
      type: String
    - contextPath: Email.Subject
      description: The subject of the email.
      type: String
    - contextPath: URL.Data
      description: The URL.
      type: String
    - contextPath: URL.Malicious.Vendor
      description: The vendor reporting the URL as malicious.
      type: String
    - contextPath: File.Name
      description: The full file name (including file extension
      type: String
    - contextPath: File.Type
      description: The file type, as determined by libmagic (same as displayed in
        file entries).
      type: String
    - contextPath: File.MD5
      description: The MD5 hash of the file.
      type: String
    - contextPath: File.SHA256
      description: The SHA256 hash of the file.
      type: String
    - contextPath: File.Malicious
      description: The vendor that reported the file as malicious.
      type: String
  - arguments:
    - auto: PREDEFINED
      default: false
      description: Incident status
      isArray: false
      name: Status
      predefined:
      - open
      - ' closed'
      required: false
      secret: false
    - default: false
      description: Timestamp is in RFC3339 format
      isArray: false
      name: created_after
      required: false
      secret: false
    - default: false
      description: Timestamp is in RFC3339 format
      isArray: false
      name: created_before
      required: false
      secret: false
    - default: false
      description: Timestamp is in RFC3339 format
      isArray: false
      name: closed_after
      required: false
      secret: false
    - default: false
      description: Timestamp is in RFC3339 format
      isArray: false
      name: closed_before
      required: false
      secret: false
    - default: false
      defaultValue: '20'
      description: Number of records to return
      isArray: false
      name: limit
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Return Incidents sorted by the given column
      isArray: false
      name: sort
      predefined:
      - created_at
      - ' closed_at'
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Return Incidents sorted by the given order. This will be applied
        to the given sort parameter.
      isArray: false
      name: direction
      predefined:
      - ascending
      - ' descending'
      required: false
      secret: false
    deprecated: false
    description: Get list of incidents details - by default return 20 incidents
    execution: false
    name: phishlabs-get-incidents
  - arguments:
    - default: false
      description: Case ID
      isArray: false
      name: id
      required: true
      secret: false
    deprecated: false
    description: Get case from Phishlabs by ID
    execution: false
    name: phishlabs-get-case-by-id
  - arguments:
    - auto: PREDEFINED
      default: false
      description: Filter cases based on the case status
      isArray: false
      name: case_status
      predefined:
      - New
      - ' Closed'
      - ' Assigned'
      - ' Rejected'
      - ' Duplicate'
      - ' Pending Input'
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Filter cases by case type
      isArray: false
      name: case_type
      predefined:
      - 419 Scam
      - ' Credential Recovery'
      - ' Crimeware'
      - ' Mobile Abuse'
      - ' Job Scam'
      - ' Other'
      - ' Pharming'
      - ' Phishing'
      - ' Phishing Redirect'
      - ' Vishing'
      required: false
      secret: false
    - default: false
      description: maximum number of cases to return, default is 20, maximum is 200
      isArray: false
      name: max_records
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Date field filter
      isArray: false
      name: date_field
      predefined:
      - caseOpen
      - ' caseClose '
      - caseModify
      required: false
      secret: false
    - default: false
      description: Date query beginning date - Timestamp is in RFC3339 format
      isArray: false
      name: begin_date
      required: false
      secret: false
    - default: false
      description: Date query ending date - Timestamp is in RFC3339 format
      isArray: false
      name: end_date
      required: false
      secret: false
    deprecated: false
    description: Get case from Phislabs by filters - by default return 20 cases.
    execution: false
    name: phishlabs-get-cases
  - arguments:
    - default: false
      description: Case ID
      isArray: false
      name: id
      required: true
      secret: false
    deprecated: false
    description: Returns the case file itself
    execution: false
    name: phishlabs-get-cases-attachment
  dockerimage: demisto/python3:3.7.4.977
  isfetch: true
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  type: python
