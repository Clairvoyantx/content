category: Data Enrichment & Threat Intelligence
commonfields:
  id: AlienVault_OTX_v2
  version: -1
configuration:
- defaultvalue: https://otx.alienvault.com
  display: Server address
  name: server
  required: true
  type: 0
- display: API Token
  name: api_token
  required: false
  type: 4
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: Query IOCs in AlienVault OTX.
display: AlienVault OTX v2
name: AlienVault_OTX_v2
script:
  commands:
  - arguments:
    - default: true
      description: ip to query
      isArray: false
      name: ip
      required: true
      secret: false
    deprecated: false
    description: Query IP in AlienVault OTX.
    execution: false
    name: ip
    outputs:
    - contextPath: IP.Address
      description: IP address.
      type: String
    - contextPath: IP.ASN
      description: 'The autonomous system name for the IP address, for example: "AS8948".'
      type: String
    - contextPath: IP.Geo.Country
      description: The country in which the IP address is located.
      type: String
    - contextPath: IP.Geo.Location
      description: 'The geolocation where the IP address is located, in the format: latitude:longitude.'
      type: String
    - contextPath: AlienVaultOTX.IP.Reputation
      description: IP reputation.
      type: String
    - contextPath: DBotScore.Score
      description: The actual score.
      type: Number
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: String
    - contextPath: DBotScore.Vendor
      description: AlienVault OTX vendor.
      type: String
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: String
  - arguments:
    - default: true
      description: domain to query
      isArray: false
      name: domain
      required: true
      secret: false
    deprecated: false
    description: Query domain in AlienVault OTX.
    execution: false
    name: domain
    outputs:
    - contextPath: Domain.Name
      description: 'The domain name, for example: "google.com".'
      type: String
    - contextPath: AlienVaultOTX.Domain.Alexa
      description: Alexa URL for domain data
      type: String
    - contextPath: AlienVaultOTX.Domain.Whois
      description: Whois URL for domain data
      type: String
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: String
    - contextPath: DBotScore.Score
      description: The actual score.
      type: Number
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: String
    - contextPath: DBotScore.Vendor
      description: AlienVault OTX vendor.
      type: String
  - arguments:
    - default: true
      description: ip to query
      isArray: false
      name: ip
      required: true
      secret: false
    deprecated: false
    description: Query IPv6 in AlienVault OTX
    execution: false
    name: alienvault-search-ipv6
    outputs:
    - contextPath: IP.Address
      description: IP address.
      type: String
    - contextPath: IP.ASN
      description: 'The autonomous system name for the IP address, for example: "AS8948".'
      type: String
    - contextPath: IP.AlienVaultOTX.Reputation
      description: AlienVault IP reputation.
      type: String
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: String
    - contextPath: DBotScore.Score
      description: The actual score.
      type: Number
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: String
    - contextPath: DBotScore.Vendor
      description: AlienVault OTX vendor..
      type: String
  - arguments:
    - default: true
      description: hostname to query
      isArray: false
      name: hostname
      required: true
      secret: false
    deprecated: false
    description: Query hostname in AlienVault OTX.
    execution: false
    name: alienvault-search-hostname
    outputs:
    - contextPath: Endpoint.Hostname
      description: The hostname that is mapped to this endpoint.
      type: String
    - contextPath: Endpoint.AlienVaultOTX.Alexa
      description: Endpoint Alexa URL.
      type: String
    - contextPath: Endpoint.AlienVaultOTX.Whois
      description: Endpoint Whois URL.
      type: String
    - contextPath: DBotScore.Score
      description: The actual score.
      type: Number
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: String
    - contextPath: DBotScore.Vendor
      description: AlienVault OTX vendor.
      type: String
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: String
  - arguments:
    - default: true
      description: File hash to query.
      isArray: false
      name: file
      required: true
      secret: false
    deprecated: false
    description: Query file in AlienVault OTX.
    execution: false
    name: file
    outputs:
    - contextPath: File.MD5
      description: The MD5 hash of the file.
      type: String
    - contextPath: File.SHA1
      description: The SHA1 hash of the file.
      type: String
    - contextPath: File.SHA256
      description: The SHA256 hash of the file.
      type: String
    - contextPath: File.Malicious.PulseIDs
      description: IDs of pulses marked this as malicious.
      type: String
    - contextPath: File.Type
      description: The file type, as determined by libmagic (same as displayed in file entries).
      type: String
    - contextPath: File.Size
      description: The size of the file in bytes.
      type: Number
    - contextPath: File.SSDeep
      description: The ssdeep hash of the file (same as displayed in file entries).
      type: String
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: String
    - contextPath: DBotScore.Score
      description: The actual score.
      type: Number
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: String
    - contextPath: DBotScore.Vendor
      description: AlienVault OTX vendor.
      type: String
  - arguments:
    - default: true
      description: The cve to query.
      isArray: false
      name: cve_id
      required: true
      secret: false
    deprecated: false
    description: Query CVE in AlienVault OTX.
    execution: false
    name: alienvault-search-cve
    outputs:
    - contextPath: CVE.ID
      description: 'The ID of the CVE, for example: "CVE-2015-1653".'
      type: String
    - contextPath: CVE.CVSS
      description: 'The CVSS of the CVE, for example: "10.0".'
      type: String
    - contextPath: CVE.Published
      description: The timestamp of when the CVE was published.
      type: String
    - contextPath: CVE.Modified
      description: The timestamp of when the CVE was last modified.
      type: String
    - contextPath: CVE.Description
      description: A description of the CVE.
      type: String
    - contextPath: DBotScore.Score
      description: The actual score.
      type: Number
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: String
    - contextPath: DBotScore.Vendor
      description: AlienVault OTX vendor.
      type: String
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: String
  - arguments:
    - auto: PREDEFINED
      default: false
      description: The type of the indicator.
      isArray: false
      name: indicator_type
      predefined:
      - IPv4
      - IPv6
      - domain
      - hostname
      - url
      required: true
      secret: false
    - default: false
      description: The indicator to search related hashes for.
      isArray: false
      name: indicator
      required: true
      secret: false
    deprecated: false
    description: URLs analyzed by AlienVault Labs on this indicator.
    execution: false
    name: alienvault-get-related-urls-by-indicator
    outputs:
    - contextPath: AlienVaultOTX.URL.Data
      description: path of the related URLs.
      type: Unknown
  - arguments:
    - default: false
      description: The indicator to search related hashes for.
      isArray: false
      name: indicator
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: The type of the indicator.
      isArray: false
      name: indicator_type
      predefined:
      - IPv4
      - IPv6
      - domain
      - hostname
      required: false
      secret: false
    deprecated: false
    description: Malwares analyzed by AlienVault Labs on this indicator.
    execution: false
    name: alienvault-get-related-hashes-by-indicator
    outputs:
    - contextPath: AlienVaultOTX.File.Hash
      description: The path of the url.
      type: Unknown
  - arguments:
    - auto: PREDEFINED
      default: false
      description: The type of the indicator.
      isArray: false
      name: indicator_type
      predefined:
      - IPv4
      - IPv6
      - domain
      - hostname
      required: true
      secret: false
    - default: false
      description: the indicator to search urls for
      isArray: false
      name: indicator
      required: true
      secret: false
    deprecated: false
    description: Passive dns records observed by AlienVault Labs pointing to this
      indicator
    execution: false
    name: alienvault-get-passive-dns-data-by-indicator
    outputs:
    - contextPath: AlienVaultOTX.PassiveDNS.Hostname
      description: The domain value.
      type: String
    - contextPath: AlienVaultOTX.PassiveDNS.IP
      description: IP passive dns.
      type: String
    - contextPath: AlienVaultOTX.PassiveDNS.Domain
      description: The domain value.
      type: String
    - contextPath: AlienVaultOTX.PassiveDNS.Type
      description: The asset type.
      type: String
    - contextPath: AlienVaultOTX.PassiveDNS.FirstSeen
      description: The first seen date.
      type: Date
    - contextPath: AlienVaultOTX.PassiveDNS.LastSeen
      description: The last seen date.
      type: Date
  - arguments:
    - default: true
      description: The page of pulses to get.
      isArray: false
      name: page
      required: true
      secret: false
    deprecated: false
    description: Search for pulses in AlienVault OTX
    execution: false
    name: alienvault-search-pulses
    outputs:
    - contextPath: AlienVaultOTX.Pulses.ID
      description: Pulse ID
      type: String
    - contextPath: AlienVaultOTX.Pulses.Author.ID
      description: Author ID
      type: String
    - contextPath: AlienVaultOTX.Pulses.Author.Username
      description: Author username
      type: String
    - contextPath: AlienVaultOTX.Pulses.Count
      description: Pulse count
      type: String
    - contextPath: AlienVaultOTX.Pulses.Modified
      description: Pulse modification date
      type: Date
    - contextPath: AlienVaultOTX.Pulses.Name
      description: Pulse name
      type: String
    - contextPath: AlienVaultOTX.Pulses.Source
      description: Pulse source
      type: String
    - contextPath: AlienVaultOTX.Pulses.SubscriberCount
      description: Pulse subscriber count
      type: String
    - contextPath: AlienVaultOTX.Pulses.Tags
      description: Pulse tags
      type: String
    - contextPath: AlienVaultOTX.Pulses.Description
      description: Pulse description
      type: String
  - arguments:
    - default: true
      description: ID of desired pules
      isArray: false
      name: pulse_id
      required: true
      secret: false
    deprecated: false
    description: Get pulse details (pulse are alian vault's entities)
    execution: false
    name: alienvault-get-pulse-details
    outputs:
    - contextPath: AlienVaultOTX.Pulses.Created
      description: Pulse created
      type: Date
    - contextPath: AlienVaultOTX.Pulses.Author.Username
      description: Pulse author username
      type: String
    - contextPath: AlienVaultOTX.Pulses.ID
      description: Pulse ID
      type: String
    - contextPath: AlienVaultOTX.Pulses.Name
      description: Pulse name
      type: String
    - contextPath: AlienVaultOTX.Pulses.Tags
      description: Pulse tags
      type: String
    - contextPath: AlienVaultOTX.Pulses.TargetedCountries
      description: Pulse targeted countries
      type: String
    - contextPath: AlienVaultOTX.Pulses.Description
      description: Pulse description
      type: String
  - arguments:
    - default: true
      description: url to query
      isArray: false
      name: url
      required: true
      secret: false
    deprecated: false
    description: Query url in AlienVault OTX.
    execution: false
    name: url
    outputs:
    - contextPath: URL.Data
      description: The URL.
      type: String
    - contextPath: AlienVaultOTX.URL.Hostname
      description: URL Hostname.
      type: String
    - contextPath: AlienVaultOTX.URL.Domain
      description: URL Domain.
      type: String
    - contextPath: AlienVaultOTX.URL.Alexa
      description: Alexa URL for domain data.
      type: String
    - contextPath: AlienVaultOTX.URL.Whois
      description: Whois URL for domain data.
      type: String
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: String
    - contextPath: DBotScore.Score
      description: The actual score.
      type: Number
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: String
    - contextPath: DBotScore.Vendor
      description: AlienVault OTX vendor.
      type: String
  dockerimage: demisto/python3:3.7.4.1150
  isfetch: false
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  type: python
  subtype: python3
tests:
  - Alienvault_OTX_v2-test
