category: Email Gateway
commonfields:
  id: MicrosoftGraphListener
  version: -1
configuration:
- defaultvalue: https://graph.microsoft.com
  display: Server URL
  name: url
  required: true
  type: 0
- display: ID (received from the admin consent - see Detailed Instructions (?)
  name: auth_id
  required: true
  type: 4
- display: Token (received from the admin consent - see Detailed Instructions (?)
    section)
  name: tenant_id
  required: true
  type: 4
- display: Key (received from the admin consent - see Detailed Instructions (?)
  name: enc_key
  required: true
  type: 4
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
- display: Email address from which to fetch incidents  (e.g. "from:example@demisto.com")
  name: mailbox_to_fetch
  required: true
  type: 0
- defaultvalue: Inbox
  display: Name of the folder from which to fetch incidents (supports Folder ID and
    sub-folders e.g. Inbox/Phishing)
  name: folder_to_fetch
  required: true
  type: 0
- defaultvalue: 15 minutes
  display: First fetch timestamp (<number> <time unit>, e.g., 12 hours, 7 days)
  name: first_fetch_interval
  required: false
  type: 0
description: Microsoft Graph lets your app get authorized access to a user's Outlook
  mail data in a personal or organization account.
display: Microsoft Graph Mail Listener And Sender
name: MicrosoftGraphListener
script:
  dockerimage: demisto/crypto:1.0.0.303
  isfetch: false
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  type: python
  subtype: python3
